@page
@model SeniorConnect.Pages.calendar.CalendarModel
@{
}

@section CustomStyle {
    <link rel="stylesheet" href="~/css/calendar.css" asp-append-version="true"/>
}

<div class="mt-5 @(Model.Activitys.Count <= 3 ? "vh-100" : "")">
    <h1 class="mb-4">Mijn activiteiten</h1>
    <div class="animate__animated animate__slideInUp">
        
        @if (Model.Activitys.Count == 0)
        {
            <div class="alert alert-info" role="alert">
                U heeft zich nog niet ingeschreven voor een activiteit.
            </div>
        }
        
        @foreach (var Activity in Model.Activitys)
        {
            <div class="card mb-3 js-signed-activity card-hover"
                 data-activity-id="@Activity.ActivityId"
                 data-activity-title="@Activity.Title"
                 data-activity-image="@Activity.Image">
                <div class="row g-0">
                    <div class="col-md-3">
                        <img src="@Activity.Image" class="img-fluid rounded-start agenda-activity-image" alt="activityImage"/>
                    </div>
                    <div class="col-md-9">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="card-title text-capitalize">@Activity.Title</h5>
                                <form method="post">
                                    <input type="hidden" asp-for="ActivityId" value="@Activity.ActivityId"/>
                                    <button class="btn btn-danger btn-sm js-cancel-activity">Annuleren</button>
                                </form>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="d-flex mb-3">
                                        <i class="bi bi-people-fill me-2"></i>
                                        <div>
                                            <p class="mb-0">Maximaal deelnemers</p>
                                            <p class="mb-0">@Activity.MaxParticipants</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="d-flex mb-3">
                                        <i class="bi bi-calendar-event me-2"></i>
                                        <div>
                                            <p class="mb-0">Datum/Tijd</p>
                                            <p class="mb-0 text-capitalize">@Activity.Date.ToString("dddd d MMMM yyyy")</p>
                                            <p class="mb-0">Om: @Activity.Date.ToString("HH:mm") uur</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="d-flex mb-3">
                                        <i class="bi bi-geo-alt me-2"></i>
                                        <div>
                                            <p class="mb-0">Plaats</p>
                                            <p class="mb-0">@Activity.Place</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@section CustomJs{
    <script asp-append-version="true">
    $(document).ready(() => {
        const activity = $(".js-signed-activity");
        
        activity.on("click", function (event){
            let activityId = this.getAttribute("data-activity-id");
            let activityTitle = this.getAttribute("data-activity-title");
            let activityImage = this.getAttribute("data-activity-image");
            
            let onClickElement = event.target;
            
            if (onClickElement.classList.contains("js-cancel-activity")) {
                event.preventDefault();
                Swal.fire({
                    title: 'Activiteit annuleren',
                    text: `Weet u zeker dat u de '${activityTitle}' activiteit wilt annuleren?`,
                    showCancelButton: true,
                    confirmButtonColor: '#0d6efd',
                    confirmButtonText: 'Ja',
                    cancelButtonText: 'Nee',
                    imageUrl: activityImage,
                    imageWidth: 400,
                    imageHeight: 300,
                }).then((result) =>{
                    if (result.isConfirmed) {
                        onClickElement.parentElement.submit();
                    }
                });
                
                return;
            }
            
            window.location = `/activity/ActivityDetail?id=${activityId}`;
        });
    });
    </script>
}